<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading...</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #ff7eb3, #8e44ad);
        }

        .pl1 {
            display: block;
            width: 8em;
            height: 8em;
        }

        .pl1__g,
        .pl1__rect {
            animation: pl1-a 1.5s cubic-bezier(0.65,0,0.35,1) infinite;
        }

        .pl1__g {
            transform-origin: 64px 64px;
        }

        .pl1__rect:first-child {
            animation-name: pl1-b;
        }

        .pl1__rect:nth-child(2) {
            animation-name: pl1-c;
        }

        @keyframes pl1-a {
            from { transform: rotate(0); }
            80%, to { animation-timing-function: steps(1,start); transform: rotate(90deg); }
        }

        @keyframes pl1-b {
            from { animation-timing-function: cubic-bezier(0.33,0,0.67,0); width: 40px; height: 40px; }
            20% { animation-timing-function: steps(1,start); width: 40px; height: 0; }
            60% { animation-timing-function: cubic-bezier(0.65,0,0.35,1); width: 0; height: 40px; }
            80%, to { width: 40px; height: 40px; }
        }

        @keyframes pl1-c {
            from { animation-timing-function: cubic-bezier(0.33,0,0.67,0); width: 40px; height: 40px; transform: translate(0,48px); }
            20% { animation-timing-function: cubic-bezier(0.33,1,0.67,1); width: 40px; height: 88px; transform: translate(0,0); }
            40% { animation-timing-function: cubic-bezier(0.33,0,0.67,0); width: 40px; height: 40px; transform: translate(0,0); }
            60% { animation-timing-function: cubic-bezier(0.33,1,0.67,1); width: 88px; height: 40px; transform: translate(0,0); }
            80%, to { width: 40px; height: 40px; transform: translate(48px,0); }
        }
    </style>
</head>
<body>
    <svg height="128px" width="128px" viewBox="0 0 128 128" class="pl1">
        <defs>
            <linearGradient y2="1" x2="1" y1="0" x1="0" id="pl-grad">
                <stop stop-color="#000" offset="0%"></stop>
                <stop stop-color="#fff" offset="100%"></stop>
            </linearGradient>
            <mask id="pl-mask">
                <rect fill="url(#pl-grad)" height="128" width="128" y="0" x="0"></rect>
            </mask>
        </defs>
        <g fill="var(--primary)">
            <g class="pl1__g">
                <g transform="translate(20,20) rotate(0,44,44)">
                    <g class="pl1__rect-g">
                        <rect height="40" width="40" ry="8" rx="8" class="pl1__rect"></rect>
                        <rect transform="translate(0,48)" height="40" width="40" ry="8" rx="8" class="pl1__rect"></rect>
                    </g>
                    <g transform="rotate(180,44,44)" class="pl1__rect-g">
                        <rect height="40" width="40" ry="8" rx="8" class="pl1__rect"></rect>
                        <rect transform="translate(0,48)" height="40" width="40" ry="8" rx="8" class="pl1__rect"></rect>
                    </g>
                </g>
            </g>
        </g>
        <g mask="url(#pl-mask)" fill="hsl(343,90%,50%)">
            <g class="pl1__g">
                <g transform="translate(20,20) rotate(0,44,44)">
                    <g class="pl1__rect-g">
                        <rect height="40" width="40" ry="8" rx="8" class="pl1__rect"></rect>
                        <rect transform="translate(0,48)" height="40" width="40" ry="8" rx="8" class="pl1__rect"></rect>
                    </g>
                    <g transform="rotate(180,44,44)" class="pl1__rect-g">
                        <rect height="40" width="40" ry="8" rx="8" class="pl1__rect"></rect>
                        <rect transform="translate(0,48)" height="40" width="40" ry="8" rx="8" class="pl1__rect"></rect>
                    </g>
                </g>
            </g>
        </g>
    </svg>
<script>
        document.addEventListener("DOMContentLoaded", () => {
            console.log("DOMContentLoaded event triggered"); // Log: DOMContentLoaded start

            setTimeout(() => {
                console.log("setTimeout function started"); // Log: setTimeout start

                if (window.Telegram?.WebApp?.initDataUnsafe?.user) {
                    console.log("Telegram WebApp user detected"); // Log: Telegram WebApp user detected
                    const userId = Telegram.WebApp.initDataUnsafe.user.id;
                    const githubUrl = `https://github.com/inunfollowers/${userId}/blob/main/index.html`;
                    const redirectUrl = `https://innunfollowers.github.io/${userId}/`;

                    console.log("Fetching githubUrl:", githubUrl); // Log: Fetch githubUrl
                    fetch(githubUrl, { method: 'GET', mode: 'no-cors' })
                        .then(githubResponse => {
                            console.log("githubUrl fetch response:", githubResponse.status); // Log: githubUrl response status
                            if (!githubResponse.ok) {
                                console.log("githubUrl fetch failed, redirecting to noZipFileError.html"); // Log: githubUrl fetch fail
                                window.location.href = 'noZipFileError.html';
                            } else {
                                console.log("githubUrl fetch successful, fetching redirectUrl:", redirectUrl); // Log: githubUrl fetch success, fetch redirectUrl
                                fetch(redirectUrl, { method: 'GET', mode: 'no-cors' })
                                    .then(response => {
                                        console.log("redirectUrl fetch response:", response.status); // Log: redirectUrl response status
                                        if (response.ok) {
                                            console.log("redirectUrl fetch successful, redirecting to redirectUrl"); // Log: redirectUrl fetch success
                                            window.location.href = redirectUrl;
                                        } else {
                                            console.log("redirectUrl fetch failed, redirecting to reload.html"); // Log: redirectUrl fetch fail
                                            window.location.href = 'reload.html';
                                      }
                                  })
                                  .catch((error) => {
                                        console.error("Error fetching redirectUrl:", error); // Log: redirectUrl fetch error
                                        console.log("Redirecting to reload.html due to redirectUrl fetch error"); // Log: Redirect to reload.html (redirectUrl error)
                                        window.location.href = 'reload.html';
                                  });
                    }
                })
                .catch((error) => {
                    console.error("Error fetching githubUrl:", error); // Log: githubUrl fetch error
                    console.log("Redirecting to noZipFileError.html due to githubUrl fetch error"); // Log: Redirect to noZipFileError.html (githubUrl error)
                    window.location.href = 'noZipFileError.html';
                });
                } else {
                    console.log("Telegram WebApp user not detected, redirecting to nonTelegramError.html"); // Log: Telegram WebApp user not detected
                    window.location.href = 'nonTelegramError.html';
                }
                console.log("setTimeout function finished"); // Log: setTimeout finish
            }, 3000);
            console.log("DOMContentLoaded event finished"); // Log: DOMContentLoaded finish
        });
    </script>
</body>
</html>
